/*
 * jQuery Mobile Framework : plugin to provide a date and time picker.
 * Copyright (c) JTSage
 * CC 3.0 Attribution.  May be relicensed without permission/notifcation.
 * https://github.com/jtsage/jquery-mobile-datebox
 */
(function(a,b){Date.prototype.getISO=function(){return String(this.getFullYear())+"-"+(this.getMonth()<9?"0":"")+String(this.getMonth()+1)+"-"+(this.getDate()<10?"0":"")+String(this.getDate())},Date.prototype.getComp=function(){return parseInt(this.getISO().replace(/-/g,""),10)},Date.prototype.copy=function(){return this.copymod()},Date.prototype.copymod=function(a,b){typeof a=="undefined"&&(a=[0,0,0,0,0,0]),typeof b=="undefined"&&(b=[0,0,0,0,0,0]);while(a.length<6)a.push(0);while(b.length<6)b.push(0);return new Date(b[0]>0?b[0]:this.getFullYear()+a[0],b[1]>0?b[1]:this.getMonth()+a[1],b[2]>0?b[2]:this.getDate()+a[2],b[3]>0?b[3]:this.getHours()+a[3],b[4]>0?b[4]:this.getMinutes()+a[4],b[5]>0?b[5]:this.getSeconds()+a[5],0)},Date.prototype.getEpoch=function(){return(this.getTime()-this.getMilliseconds())/1e3},Date.prototype.adjust=function(a,b){switch(a){case"y":this.setFullYear(this.getFullYear()+b);break;case"m":this.setMonth(this.getMonth()+b);break;case"d":this.setDate(this.getDate()+b);break;case"h":this.setHours(this.getHours()+b);break;case"i":this.setMinutes(this.getMinutes()+b);break;case"s":this.setSeconds(this.getSeconds()+b)}return this.getTime()},a.widget("mobile.datebox",a.mobile.widget,{options:{version:"1.0.1-2012022700",theme:!1,defaultTheme:"c",pickPageTheme:"b",pickPageInputTheme:"e",pickPageButtonTheme:"a",pickPageHighButtonTheme:"e",pickPageOHighButtonTheme:"e",pickPageOAHighButtonTheme:"e",pickPageODHighButtonTheme:"e",pickPageTodayButtonTheme:"e",pickPageSlideButtonTheme:"d",pickPageFlipButtonTheme:"b",forceInheritTheme:!1,centerWindow:!1,calHighToday:!0,calHighPicked:!0,transition:"pop",noAnimation:!1,disableManualInput:!1,disabled:!1,wheelExists:!1,swipeEnabled:!0,zindex:"500",debug:!1,clickEvent:"vclick",numberInputEnhance:!0,internalInputType:"text",resizeListener:!0,titleDialogLabel:!1,meridiemLetters:["AM","PM"],timeOutputOverride:!1,timeFormats:{12:"%l:%M %p",24:"%k:%M"},durationFormat:"DD ddd, hh:ii:ss",timeOutput:!1,rolloverMode:{m:!0,d:!0,h:!0,i:!0,s:!0},mode:"datebox",calShowDays:!0,calShowOnlyMonth:!1,useDialogForceTrue:!1,useDialogForceFalse:!0,fullScreen:!1,fullScreenAlways:!1,useDialog:!1,useModal:!1,useInline:!1,useInlineBlind:!1,useClearButton:!1,collapseButtons:!1,noButtonFocusMode:!1,focusMode:!1,noButton:!1,noSetButton:!1,openCallback:!1,openCallbackArgs:[],closeCallback:!1,closeCallbackArgs:[],open:!1,nestedBox:!1,lastDuration:!1,fieldsOrder:!1,fieldsOrderOverride:!1,durationOrder:["d","h","i","s"],defaultDateFormat:"%Y-%m-%d",dateFormat:!1,timeFormatOverride:!1,headerFormat:!1,dateOutput:!1,minuteStep:1,calTodayButton:!1,calWeekMode:!1,calWeekModeFirstDay:1,calWeekModeHighlight:!0,calStartDay:!1,defaultPickerValue:!1,defaultDate:!1,minYear:!1,maxYear:!1,afterToday:!1,beforeToday:!1,maxDays:!1,minDays:!1,highDays:!1,highDates:!1,highDatesAlt:!1,blackDays:!1,blackDates:!1,enableDates:!1,fixDateArrays:!1,durationSteppers:{d:1,h:1,i:1,s:1},useLang:"en",lang:{en:{setDateButtonLabel:"Set Date",setTimeButtonLabel:"Set Time",setDurationButtonLabel:"Set Duration",calTodayButtonLabel:"Jump to Today",titleDateDialogLabel:"Set Date",titleTimeDialogLabel:"Set Time",daysOfWeek:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],daysOfWeekShort:["Su","Mo","Tu","We","Th","Fr","Sa"],monthsOfYear:["January","February","March","April","May","June","July","August","September","October","November","December"],monthsOfYearShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],durationLabel:["Days","Hours","Minutes","Seconds"],durationDays:["Day","Days"],timeFormat:24,headerFormat:"%A, %B %-d, %Y",tooltip:"Open Date Picker",nextMonth:"Next Month",prevMonth:"Previous Month",dateFieldOrder:["m","d","y"],timeFieldOrder:["h","i","a"],slideFieldOrder:["y","m","d"],dateFormat:"%Y-%m-%d",useArabicIndic:!1,isRTL:!1,calStartDay:0,clearButton:"Clear"}}},destroy:function(){a(this.pickPage).remove(),a.Widget.prototype.destroy.call(this)},_dateboxHandler:function(b,c){var d=a(this).data("datebox");if(!b.isPropagationStopped())switch(c.method){case"close":d.close(c.fromCloseButton);break;case"open":d.open();break;case"set":a(this).val(c.value),a(this).trigger("change");break;case"doset":a.inArray(d.options.mode,["timebox","durationbox","timeflipbox"])>-1?a(this).trigger("datebox",{method:"set",value:d._formatTime(d.theDate),date:d.theDate}):a(this).trigger("datebox",{method:"set",value:d._formatDate(d.theDate),date:d.theDate});break;case"dooffset":d._offset(c.type,c.amount,!0);break;case"dorefresh":d._update();break;case"doreset":d.hardreset();break;case"doclear":a(this).val("")}},_getCoords:function(b){var c=b,d=b.focusedEl.offset(),e=b.focusedEl.outerHeight(),f=b.focusedEl.outerWidth(),g=a.mobile.activePage.width(),h=a(window).scrollTop(),i=a(window).height(),j=b.pickerContent.innerWidth(),k=b.pickerContent.outerHeight(),l=!1,m=0,n=0,o=0,p=a(document).height(),q={high:a(window).height(),width:a.mobile.activePage.width(),fullTop:a(window).scrollTop(),fullLeft:a(window).scrollLeft()};return b.options.centerWindow?(q.winTop=h+(i/2-k/2),q.winLeft=g/2-j/2):(l=a(".ui-header",a.mobile.activePage),l.length>0&&(l.is(".ui-header-fixed")?n=l.outerHeight()+2:m+=l.outerHeight()+2),l=a(".ui-footer",a.mobile.activePage),l.length>0&&(l.is(".ui-footer-fixed")?o=l.outerHeight()+2:p-=l.outerHeight()+2),q.winLeft=d.left+f/2-j/2,g<450&&(q.winLeft=g/2-j/2),q.winTop=d.top+e/2-k/2,q.winTop+k>p&&(q.winTop+=p-(q.winTop+k)),o>0&&q.winTop+k-h>i-o&&(q.winTop=i-o+h-k),q.winTop<m&&(q.winTop=m),n>0&&q.winTop<h+n?q.winTop=h+n:h>m&&h>q.winTop&&(q.winTop=h+2)),q},_fixArray:function(b){var c=0,d=this,e=new RegExp("^([0-9]+)-([0-9]+)-([0-9]+)$"),f=null;if(a.isArray(b))for(c=0;c<b.length;c++)f=[0],f=e.exec(b[c]),f.length===4&&(b[c]=f[1]+"-"+d._zPad(parseInt(f[2],10))+"-"+d._zPad(parseInt(f[3],10)));return b},_digitReplace:function(a,b){var c=48,d=57,e=1584,f=null,g=null,h="";b===-1&&(c+=e,d+=e,e=-1584);for(f=0;f<a.length;f++)g=a.charCodeAt(f),g>=c&&g<=d?h+=String.fromCharCode(g+e):h+=String.fromCharCode(g);return h},_makeDisplayIndic:function(){var b=this,c=this.options;b.pickerContent.find("*").each(function(){a(this).children().length<1?a(this).text(b._digitReplace(a(this).text())):a(this).hasClass("ui-datebox-slideday")&&a(this).html(b._digitReplace(a(this).html()))}),b.pickerContent.find("input").each(function(){a(this).val(b._digitReplace(a(this).val()))})},_zPad:function(a){return(a<10?"0":"")+String(a)},_makeOrd:function(a){var b=a%10;return a>9&&a<21?"th":b>3?"th":["th","st","nd","rd"][b]},_isInt:function(a){return a.toString().search(/^[0-9]+$/)===0},_getFirstDay:function(a){return a.copymod([0],[0,0,1]).getDay()},_getRecDays:function(a,b,c){b===null&&(b=this.theDate.getMonth()+1),a===null&&(a=this.theDate.getFullYear());var d=this,e=new Date(a,b-1,1,0,0,0,0),f=[],g;e.getDay()>c?e.setDate(8-(e.getDay()-c)):e.getDay()<c&&e.setDate(1+(c-e.getDay())),f[0]=e.getISO();for(g=1;g<6;g++)e.setDate(e.getDate()+7),e.getMonth()+1===b&&(f[g]=e.getISO());return f},_getLastDate:function(a){return 32-a.copymod([0],[0,0,32,13]).getDate()},_getLastDateBefore:function(a){return 32-a.copymod([0,-1],[0,0,32,13]).getDate()},_formatter:function(a,b){var c=this,d=this.options;return a.match(/%/)?a=a.replace(/%(0|-)*([a-z])/gi,function(a,e,g,h,i){switch(g){case"%":return"%";case"a":return d.lang[d.useLang].daysOfWeekShort[b.getDay()];case"A":return d.lang[d.useLang].daysOfWeek[b.getDay()];case"b":return d.lang[d.useLang].monthsOfYearShort[b.getMonth()];case"B":return d.lang[d.useLang].monthsOfYear[b.getMonth()];case"C":return b.getFullYear().toString().substr(0,2);case"d":return e==="-"?b.getDate():c._zPad(b.getDate());case"H":case"k":return e==="-"?b.getHours():c._zPad(b.getHours());case"I":case"l":return e==="-"?b.getHours()===0||b.getHours()===12?12:b.getHours()<12?b.getHours():b.getHours()-12:c._zPad(b.getHours()===0||b.getHours()===12?12:b.getHours()<12?b.getHours():b.getHours()-12);case"m":return e==="-"?b.getMonth()+1:c._zPad(b.getMonth()+1);case"M":return e==="-"?b.getMinutes():c._zPad(b.getMinutes());case"p":return b.getHours()<12?d.meridiemLetters[0].toUpperCase():d.meridiemLetters[1].toUpperCase();case"P":return b.getHours()<12?d.meridiemLetters[0].toLowerCase():d.meridiemLetters[1].toLowerCase();case"s":return b.getEpoch;case"S":return e==="-"?b.getSeconds():c._zPad(b.getSeconds());case"w":return b.getDay();case"y":return b.getFullYear().toString().substr(2,2);case"Y":return b.getFullYear();case"o":return c._makeOrd(b.getDate());default:return a}}):(a=a.replace("HH",this._zPad(b.getHours())),a=a.replace("GG",b.getHours()),a=a.replace("hh",this._zPad(b.getHours()===0||b.getHours()===12?12:b.getHours()<12?b.getHours():b.getHours()-12)),a=a.replace("gg",b.getHours()===0||b.getHours()===12?12:b.getHours()<12?b.getHours():b.getHours()-12),a=a.replace("ii",this._zPad(b.getMinutes())),a=a.replace("ss",this._zPad(b.getSeconds())),a=a.replace("AA",b.getHours()<12?this.options.meridiemLetters[0].toUpperCase():this.options.meridiemLetters[1].toUpperCase()),a=a.replace("aa",b.getHours()<12?this.options.meridiemLetters[0].toLowerCase():this.options.meridiemLetters[1].toLowerCase()),a=a.replace("SS",this._makeOrd(b.getDate())),a=a.replace("YYYY",b.getFullYear()),a=a.replace("mmmm",this.options.lang[this.options.useLang].monthsOfYearShort[b.getMonth()]),a=a.replace("mmm",this.options.lang[this.options.useLang].monthsOfYear[b.getMonth()]),a=a.replace("MM",this._zPad(b.getMonth()+1)),a=a.replace("mm",b.getMonth()+1),a=a.replace("dddd",this.options.lang[this.options.useLang].daysOfWeekShort[b.getDay()]),a=a.replace("ddd",this.options.lang[this.options.useLang].daysOfWeek[b.getDay()]),a=a.replace("DD",this._zPad(b.getDate())),a=a.replace("dd",b.getDate()),a=a.replace("UU",b.getEpoch())),this.options.lang[this.options.useLang].useArabicIndic===!0&&(a=this._digitReplace(a)),a},_formatHeader:function(a){return this.options.headerFormat!==!1?this._formatter(this.options.headerFormat,a):this._formatter(this.options.lang[this.options.useLang].headerFormat,a)},_formatDate:function(a){return this._formatter(this.options.dateOutput,a)},_formatTime:function(a){var b=this,c=[!1,!1,!1],d,e,f,g,h=this.options.durationFormat,i=[0,0,0,0];return this.options.mode==="durationbox"?(d=this.options.durationFormat,d=d.replace(/ddd/g,".+?"),d=d.replace(/DD|ss|hh|ii/g,"([0-9Dhis]+)"),d=new RegExp("^"+d+"$"),e=d.exec(this.options.durationFormat),f=b.theDate.getEpoch()-b.initDate.getEpoch(),g=f,i[0]=parseInt(f/86400,10),f-=i[0]*60*60*24,i[1]=parseInt(f/3600,10),f-=i[1]*60*60,i[2]=parseInt(f/60,10),f-=i[2]*60,i[3]=f,e[0].match(/DD/)||(c[0]=!0,i[1]=i[1]+i[0]*24),e[0].match(/hh/)||(c[1]=!0,i[2]=i[2]+i[1]*60),e[0].match(/ii/)||(c[2]=!0,i[3]=i[3]+i[2]*60),h=h.replace("DD",i[0]),h=h.replace("ddd",i[0]>1?this.options.lang[this.options.useLang].durationDays[1]:this.options.lang[this.options.useLang].durationDays[0]),h=h.replace("hh",b._zPad(i[1])),h=h.replace("ii",b._zPad(i[2])),h=h.replace("ss",b._zPad(i[3])),this.options.lang[this.options.useLang].useArabicIndic===!0?this._digitReplace(h):h):this._formatter(b.options.timeOutput,a)},_makeDate:function(b){b=a.trim(b);var c=this.options,d=this,e=null,f=null,g=null,h=null,i=new Date,j=[!1,!1,!1],k=[i.getFullYear(),i.getMonth(),i.getDate(),i.getHours(),i.getMinutes(),i.getSeconds(),0],l;c.lang[this.options.useLang].useArabicIndic===!0&&(b=this._digitReplace(b,-1));if(c.mode==="durationbox"){e=c.durationFormat,e=e.replace(/ddd/g,".+?"),e=e.replace(/DD|ss|hh|ii/g,"([0-9Dhis]+)"),e=new RegExp("^"+e+"$"),f=e.exec(b),g=e.exec(c.durationFormat);if(f===null||f.length!==g.length)return typeof c.defaultPickerValue=="number"&&c.defaultPickerValue>0?new Date((d.initDate.getEpoch()+parseInt(c.defaultPickerValue,10))*1e3):new Date(d.initDate.getTime());h=d.initDate.getEpoch();for(l=0;l<f.length;l++)g[l].match(/^DD$/i)&&(h+=parseInt(f[l],10)*60*60*24),g[l].match(/^hh$/i)&&(h+=parseInt(f[l],10)*60*60),g[l].match(/^ii$/i)&&(h+=parseInt(f[l],10)*60),g[l].match(/^ss$/i)&&(h+=parseInt(f[l],10));return new Date(h*1e3)}c.mode==="timebox"||c.mode==="timeflipbox"?e=c.timeOutput:e=c.dateOutput;if(e.match(/%/)){e=e.replace(/%(0|-)*([a-z])/gi,function(a,b,c,d,e){switch(c){case"p":case"P":case"b":case"B":return"("+a+"|.+?)";case"H":case"k":case"I":case"l":case"m":case"M":case"S":case"d":return"("+a+"|"+(b==="-"?"[0-9]{1,2}":"[0-9]{2}")+")";case"s":return"("+a+"|[0-9]+)";case"y":return"("+a+"|[0-9]{2})";case"Y":return"("+a+"|[0-9]{1,4})";default:return".+?"}}),e=new RegExp("^"+e+"$"),f=e.exec(b),c.mode==="timebox"||c.mode==="timeflipbox"?g=e.exec(c.timeOutput):g=e.exec(c.dateOutput);if(f===null||f.length!==g.length){if(c.defaultPickerValue!==!1){if(a.isArray(c.defaultPickerValue)&&c.defaultPickerValue.length===3)return c.mode==="timebox"||c.mode==="timeflipbox"?new Date(k[0],k[1],k[2],c.defaultPickerValue[0],c.defaultPickerValue[1],c.defaultPickerValue[2],0):new Date(c.defaultPickerValue[0],c.defaultPickerValue[1],c.defaultPickerValue[2],0,0,0,0);if(typeof c.defaultPickerValue=="number")return new Date(c.defaultPickerValue*1e3);c.mode==="timebox"||c.mode==="timeflipbox"?(h=c.defaultPickerValue.split(":"),h.length===3&&(i=new Date(k[0],k[1],k[2],parseInt(h[0],10),parseInt(h[1],10),parseInt(h[2],10),0),isNaN(i.getDate())&&(i=new Date))):(h=c.defaultPickerValue.split("-"),h.length===3&&(i=new Date(parseInt(h[0],10),parseInt(h[1],10)-1,parseInt(h[2],10),0,0,0,0),isNaN(i.getDate())&&(i=new Date)))}}else for(l=0;l<f.length;l++)g[l]==="%s"&&(k[6]=parseInt(f[l],10)),g[l].match(/^%.*S$/)&&(k[5]=parseInt(f[l],10)),g[l].match(/^%.*M$/)&&(k[4]=parseInt(f[l],10)),g[l].match(/^%.*(H|k|I|l)$/)&&(k[3]=parseInt(f[l],10)),g[l].match(/^%.*d$/)&&(k[2]=parseInt(f[l],10)),g[l].match(/^%.*m$/)&&(k[1]=parseInt(f[l],10)-1),g[l].match(/^%.*Y$/)&&(k[0]=parseInt(f[l],10)),g[l].match(/^%.*y$/)&&(c.afterToday===!0?k[0]=parseInt("20"+f[l],10):parseInt(f[l],10)<38?k[0]=parseInt("20"+f[l],10):k[0]=parseInt("19"+f[l],10)),g[l].match(/^%(0|-)*(p|P)$/)&&(f[l].toLowerCase().charAt(0)==="a"&&k[3]===12?k[3]=0:f[l].toLowerCase().charAt(0)==="p"&&k[3]!==12&&(k[3]=k[3]+12)),g[l]==="%B"&&(h=a.inArray(f[l],c.lang[c.useLang].monthsOfYear),h>-1&&(k[1]=h)),g[l]==="%b"&&(h=a.inArray(f[l],c.lang[c.useLang].monthsOfYearShort),h>-1&&(k[1]=h));return g[0].match(/%s/)?i=new Date(k[6]*1e3):g[0].match(/%(.)*(I|l|H|k|s|M)/)?(i=new Date(k[0],k[1],k[2],k[3],k[4],k[5],0),k[0]<100&&i.setFullYear(k[0])):(i=new Date(k[0],k[1],k[2],0,0,0,0),k[0]<100&&i.setFullYear(k[0])),i}e=e.replace(/dddd|mmmm/g,"(.+?)"),e=e.replace(/ddd|SS/g,".+?"),e=e.replace(/mmm/g,"(.+?)"),e=e.replace(/ *AA/ig," *(.*?)"),e=e.replace(/yyyy|dd|mm|gg|hh|ii/ig,"([0-9yYdDmMgGhHi]+)"),e=e.replace(/ss|UU/g,"([0-9sU]+)"),e=new RegExp("^"+e+"$"),f=e.exec(b),c.mode==="timebox"||c.mode==="timeflipbox"?g=e.exec(c.timeOutput):g=e.exec(c.dateOutput);if(f===null||f.length!==g.length){if(c.defaultPickerValue!==!1){if(a.isArray(c.defaultPickerValue)&&c.defaultPickerValue.length===3)return c.mode==="timebox"||c.mode==="timeflipbox"?new Date(k[0],k[1],k[2],c.defaultPickerValue[0],c.defaultPickerValue[1],c.defaultPickerValue[2],0):new Date(c.defaultPickerValue[0],c.defaultPickerValue[1],c.defaultPickerValue[2],0,0,0,0);if(typeof c.defaultPickerValue=="number")return new Date(c.defaultPickerValue*1e3);c.mode==="timebox"||c.mode==="timeflipbox"?(h=c.defaultPickerValue.split(":"),h.length===3&&(i=new Date(k[0],k[1],k[2],parseInt(h[0],10),parseInt(h[1],10),parseInt(h[2],10),0),isNaN(i.getDate())&&(i=new Date))):(h=c.defaultPickerValue.split("-"),h.length===3&&(i=new Date(parseInt(h[0],10),parseInt(h[1],10)-1,parseInt(h[2],10),0,0,0,0),isNaN(i.getDate())&&(i=new Date)))}}else for(l=0;l<f.length;l++)g[l].match(/^UU$/)&&(k[6]=parseInt(f[l],10)),g[l].match(/^gg$/i)&&(k[3]=parseInt(f[l],10)),g[l].match(/^hh$/i)&&(k[3]=parseInt(f[l],10)),g[l].match(/^ii$/i)&&(k[4]=parseInt(f[l],10)),g[l].match(/^ss$/)&&(k[5]=parseInt(f[l],10)),g[l].match(/^dd$/i)&&(k[2]=parseInt(f[l],10)),g[l].match(/^mm$/i)&&(k[1]=parseInt(f[l],10)-1),g[l].match(/^yyyy$/i)&&(k[0]=parseInt(f[l],10)),g[l].match(/^AA$/i)&&(f[l].toLowerCase().charAt(0)==="a"&&k[3]===12?k[3]=0:f[l].toLowerCase().charAt(0)==="p"&&k[3]!==12&&(k[3]=k[3]+12)),g[l].match(/^mmm$/i)&&(h=a.inArray(f[l],c.lang[c.useLang].monthsOfYear),h>-1&&(k[1]=h)),g[l].match(/^mmmm$/i)&&(h=a.inArray(f[l],c.lang[c.useLang].monthsOfYearShort),h>-1&&(k[1]=h));return g[0].match(/UU/)?new Date(k[6]*1e3):g[0].match(/G|g|i|s|H|h|A/)?new Date(k[0],k[1],k[2],k[3],k[4],k[5],0):new Date(k[0],k[1],k[2],0,0,0,0)},_hoover:function(b){a(b).toggleClass("ui-btn-up-"+a(b).jqmData("theme")+" ui-btn-down-"+a(b).jqmData("theme"))},_offset:function(a,b,c){var d=this,e=this.options,f=!1;typeof c=="undefined"&&(c=!0),d.input.trigger("datebox",{method:"offset",type:a,amount:b});switch(a){case"y":f=!0;break;case"m":if(e.rolloverMode.m||d.theDate.getMonth()+b<12&&d.theDate.getMonth()+b>-1)f=!0;break;case"d":if(e.rolloverMode.d||d.theDate.getDate()+b>0&&d.theDate.getDate()+b<d._getLastDate(d.theDate)+1)f=!0;break;case"h":if(e.rolloverMode.h||d.theDate.getHours()+b>-1&&d.theDate.getHours()+b<24)f=!0;break;case"i":if(e.rolloverMode.i||d.theDate.getMinutes()+b>-1&&d.theDate.getMinutes()+b<60)f=!0;break;case"s":if(e.rolloverMode.s||d.theDate.getSeconds()+b>-1&&d.theDate.getSeconds()+b<60)f=!0;break;case"a":d.pickerMeri.val()===e.meridiemLetters[0]?d._offset("h",12,!1):d._offset("h",-12,!1)}f===!0&&d.theDate.adjust(a,b),c===!0&&d._update()},_updateduration:function(){var a=this,b=a.initDate.getEpoch();a._isInt(a.pickerDay.val())||a.pickerDay.val(0),a._isInt(a.pickerHour.val())||a.pickerHour.val(0),a._isInt(a.pickerMins.val())||a.pickerMins.val(0),a._isInt(a.pickerSecs.val())||a.pickerSecs.val(0),b+=parseInt(a.pickerDay.val(),10)*60*60*24,b+=parseInt(a.pickerHour.val(),10)*60*60,b+=parseInt(a.pickerMins.val(),10)*60,b+=parseInt(a.pickerSecs.val(),10),a.theDate.setTime(b*1e3),a._update()},_checkConstraints:function(){var b=this,c=null,d=this.options;b.dateOK=!0,d.afterToday!==!1&&(c=new Date,b.theDate<c&&(b.theDate=c)),d.beforeToday!==!1&&(c=new Date,b.theDate>c&&(b.theDate=c)),d.maxDays!==!1&&(c=new Date,c.adjust("d",d.maxDays),b.theDate>c&&(b.theDate=c)),d.minDays!==!1&&(c=new Date,c.adjust("d",-1*d.minDays),b.theDate<c&&(b.theDate=c)),d.maxYear!==!1&&(c=new Date(d.maxYear,0,1),c.adjust("d",-1),b.theDate>c&&(b.theDate=c)),d.minYear!==!1&&(c=new Date(d.minYear,0,1),b.theDate<c&&(b.theDate=c)),d.blackDates!==!1&&a.inArray(b.theDate.getISO(),d.blackDates)>-1&&(b.dateOK=!1),d.blackDays!==!1&&a.inArray(b.theDate.getDay(),d.blackDays)>-1&&(b.dateOK=!1),a.inArray(d.mode,["timebox","durationbox","timeflipbox"])>-1&&(b.dateOK=!0)},_orientChange:function(a){var b=a.data.widget,c=a.data.widget.options,d=a.data.widget._getCoords(a.data.widget);a.stopPropagation();if(!b.pickerContent.is(":visible")||c.useDialog===!0)return!1;c.fullScreen==1&&(d.width<400||c.fullScreenForce===!0)?b.pickerContent.css({top:d.fullTop,left:d.fullLeft,height:d.high,width:d.width,maxWidth:d.width}):b.pickerContent.css({top:d.winTop,left:d.winLeft})},_update:function(){var b=this,c=b.options,d=null,e,f,g,h,i,j,k,l,m,n,o,p={d:86400,h:3600,i:60,s:1},q={};b.input.trigger("datebox",{method:"refresh"}),c.mode==="durationbox"&&(e=b.theDate.getEpoch()-b.initDate.getEpoch(),e<0&&(e=0,b.theDate.setTime(b.initDate.getTime())),c.lastDuration=e,j=parseInt(e/p.d,10),e-=j*p.d,b.pickerDay.val(j),j=parseInt(e/p.h,10),e-=j*p.h,b.pickerHour.val(j),j=parseInt(e/p.i,10),e-=j*p.i,b.pickerMins.val(j),b.pickerSecs.val(parseInt(e,10))),c.mode==="timebox"&&(c.minuteStep!==1&&(e=b.theDate.getMinutes()%c.minuteStep,e!==0&&b.theDate.adjust("m",-1*e)),b.pickerMins.val(b._zPad(b.theDate.getMinutes())),c.lang[c.useLang].timeFormat===12||c.timeFormatOverride===12?b.theDate.getHours()>11?(b.pickerMeri.val(c.meridiemLetters[1]),b.theDate.getHours()===12?b.pickerHour.val(12):b.pickerHour.val(b.theDate.getHours()-12)):(b.pickerMeri.val(c.meridiemLetters[0]),b.theDate.getHours()===0?b.pickerHour.val(12):b.pickerHour.val(b.theDate.getHours())):b.pickerHour.val(b.theDate.getHours()));if(c.mode==="flipbox"||c.mode==="timeflipbox"){b._checkConstraints(),l=b._makeDate(b.input.val()),b.controlsHeader.empty().html(b._formatHeader(b.theDate));for(j=0;j<c.fieldsOrder.length;j++){n=!0;switch(c.fieldsOrder[j]){case"y":i=b.pickerYar.find("ul"),i.empty();for(e=-15;e<16;e++)k=l.getFullYear()===b.theDate.getFullYear()+e?c.pickPageHighButtonTheme:c.pickPageFlipButtonTheme,e===0&&(k=c.pickPageButtonTheme),a("<li>",{"class":"ui-body-"+k,style:n===!0?"margin-top: -453px":""}).html("<span>"+(b.theDate.getFullYear()+e)+"</span>").appendTo(i),n=!1;break;case"m":i=b.pickerMon.find("ul"),i.empty();for(e=-12;e<13;e++)d=new Date(b.theDate.getFullYear(),b.theDate.getMonth(),1),d.adjust("m",e),k=l.getMonth()===d.getMonth()&&l.getYear()===d.getYear()?c.pickPageHighButtonTheme:c.pickPageFlipButtonTheme,e===0&&(k=c.pickPageButtonTheme),a("<li>",{"class":"ui-body-"+k,style:n===!0?"margin-top: -357px":""}).html("<span>"+c.lang[c.useLang].monthsOfYearShort[d.getMonth()]+"</span>").appendTo(i),n=!1;break;case"d":i=b.pickerDay.find("ul"),i.empty();for(e=-15;e<16;e++){d=b.theDate.copy(),d.adjust("d",e),o="";if(c.blackDates!==!1&&a.inArray(d.getISO(),c.blackDates)>-1||c.blackDays!==!1&&a.inArray(d.getDay(),c.blackDays)>-1)o=" ui-datebox-griddate-disable";k=l.getDate()===d.getDate()&&l.getMonth()===d.getMonth()&&l.getYear()===d.getYear()?c.pickPageHighButtonTheme:c.pickPageFlipButtonTheme,e===0&&(k=c.pickPageButtonTheme),a("<li>",{"class":"ui-body-"+k+o,style:n===!0?"margin-top: -453px":""}).html("<span>"+d.getDate()+"</span>").appendTo(i),n=!1}break;case"h":i=b.pickerHour.find("ul"),i.empty();for(e=-12;e<13;e++)d=b.theDate.copy(),d.adjust("h",e),k=e===0?c.pickPageButtonTheme:c.pickPageFlipButtonTheme,a("<li>",{"class":"ui-body-"+k,style:n===!0?"margin-top: -357px":""}).html("<span>"+(c.lang[c.useLang].timeFormat===12||c.timeFormatOverride===12?d.getHours()===0?"12":d.getHours()<12?d.getHours():d.getHours()===12?"12":d.getHours()-12:d.getHours())+"</span>").appendTo(i),n=!1;break;case"i":i=b.pickerMins.find("ul"),i.empty();for(e=-30;e<31;e++)c.minuteStep>1&&b.theDate.setMinutes(b.theDate.getMinutes()-b.theDate.getMinutes()%c.minuteStep),d=b.theDate.copy(),d.adjust("i",e*c.minuteStep),k=e===0?c.pickPageButtonTheme:c.pickPageFlipButtonTheme,a("<li>",{"class":"ui-body-"+k,style:n===!0?"margin-top: -933px":""}).html("<span>"+b._zPad(d.getMinutes())+"</span>").appendTo(i),n=!1;break;case"a":i=b.pickerMeri.find("ul"),i.empty(),b.theDate.getHours()>11?(n="-65",k=[c.pickPageFlipButtonTheme,c.pickPageButtonTheme]):(n="-33",k=[c.pickPageButtonTheme,c.pickPageFlipButtonTheme]),a("<li>").appendTo(i).clone().appendTo(i),a("<li>",{"class":"ui-body-"+k[0],style:"margin-top: "+n+"px"}).html("<span>"+c.meridiemLetters[0]+"</span>").appendTo(i),a("<li>",{"class":"ui-body-"+k[1]}).html("<span>"+c.meridiemLetters[1]+"</span>").appendTo(i),a("<li>").appendTo(i).clone().appendTo(i)}}}if(c.mode==="slidebox"){b._checkConstraints(),l=b._makeDate(b.input.val()),b.controlsHeader.empty().html(b._formatHeader(b.theDate)),b.controlsInput.empty(),b.controlsInput.delegate(".ui-datebox-sliderow-int>div",c.clickEvent,function(c){c.preventDefault(),b._offset(a(this).parent().jqmData("rowtype"),parseInt(a(this).jqmData("offset"),10))}),b.controlsInput.delegate(".ui-datebox-sliderow-int>div","vmouseover vmouseout",function(){b._hoover(this)}),c.wheelExists&&b.controlsInput.delegate(".ui-datebox-sliderow-int","mousewheel",function(c,d){c.preventDefault(),b._offset(a(this).jqmData("rowtype"),d>0?1:-1)}),c.swipeEnabled&&b.controlsInput.delegate(".ui-datebox-sliderow-int",b.START_DRAG,function(c){b.dragMove||(b.dragMove=!0,b.dragTarget=a(this),b.dragPos=parseInt(b.dragTarget.css("marginLeft").replace(/px/i,""),10),b.dragStart=b.touch?c.originalEvent.changedTouches[0].pageX:c.pageX,b.dragEnd=!1,c.stopPropagation(),c.preventDefault())});for(j=0;j<c.fieldsOrder.length;j++){m=a("<div>").jqmData("rowtype",c.fieldsOrder[j]),i=a("<div>",{"class":"ui-datebox-sliderow-int"}).jqmData("rowtype",c.fieldsOrder[j]).appendTo(m),c.lang[c.useLang].isRTL===!0&&i.css("direction","rtl");switch(c.fieldsOrder[j]){case"y":m.addClass("ui-datebox-sliderow-ym"),i.css("marginLeft","-333px");for(e=-5;e<6;e++)k=l.getFullYear()===b.theDate.getFullYear()+e?c.pickPageHighButtonTheme:c.pickPageSlideButtonTheme,e===0&&(k=c.pickPageButtonTheme),a("<div>",{"class":"ui-datebox-slideyear ui-corner-all ui-btn-up-"+k}).html(b.theDate.getFullYear()+e).jqmData("offset",e).jqmData("theme",k).appendTo(i);break;case"m":m.addClass("ui-datebox-sliderow-ym"),i.css("marginLeft","-204px");for(e=-6;e<7;e++)d=new Date(b.theDate.getFullYear(),b.theDate.getMonth(),1),d.adjust("m",e),k=l.getMonth()===d.getMonth()&&l.getYear()===d.getYear()?c.pickPageHighButtonTheme:c.pickPageSlideButtonTheme,e===0&&(k=c.pickPageButtonTheme),a("<div>",{"class":"ui-datebox-slidemonth ui-corner-all ui-btn-up-"+k}).jqmData("offset",e).jqmData("theme",k).html(c.lang[c.useLang].monthsOfYearShort[d.getMonth()]).appendTo(i);break;case"d":m.addClass("ui-datebox-sliderow-d"),i.css("marginLeft","-386px");for(e=-15;e<16;e++){d=b.theDate.copy(),d.adjust("d",e),o="";if(c.blackDates!==!1&&a.inArray(d.getISO(),c.blackDates)>-1||c.blackDays!==!1&&a.inArray(d.getDay(),c.blackDays)>-1)o=" ui-datebox-griddate-disable";k=l.getDate()===d.getDate()&&l.getMonth()===d.getMonth()&&l.getYear()===d.getYear()?c.pickPageHighButtonTheme:c.pickPageSlideButtonTheme,e===0&&(k=c.pickPageButtonTheme),a("<div>",{"class":"ui-datebox-slideday ui-corner-all ui-btn-up-"+k+o}).jqmData("offset",e).jqmData("theme",k).html(d.getDate()+'<br /><span class="ui-datebox-slidewday">'+c.lang[c.useLang].daysOfWeekShort[d.getDay()]+"</span>").appendTo(i)}break;case"h":m.addClass("ui-datebox-sliderow-hi"),i.css("marginLeft","-284px");for(e=-12;e<13;e++)d=b.theDate.copy(),d.adjust("h",e),k=e===0?c.pickPageButtonTheme:c.pickPageSlideButtonTheme,a("<div>",{"class":"ui-datebox-slidehour ui-corner-all ui-btn-up-"+k}).jqmData("offset",e).jqmData("theme",k).html(c.lang[c.useLang].timeFormat===12||c.timeFormatOverride===12?d.getHours()===0?'12<span class="ui-datebox-slidewday">AM</span>':d.getHours()<12?d.getHours()+'<span class="ui-datebox-slidewday">AM</span>':d.getHours()===12?'12<span class="ui-datebox-slidewday">PM</span>':d.getHours()-12+'<span class="ui-datebox-slidewday">PM</span>':d.getHours()).appendTo(i);break;case"i":m.addClass("ui-datebox-sliderow-hi"),i.css("marginLeft","-896px");for(e=-30;e<31;e++)d=b.theDate.copy(),d.adjust("i",e),k=e===0?c.pickPageButtonTheme:c.pickPageSlideButtonTheme,a("<div>",{"class":"ui-datebox-slidemins ui-corner-all ui-btn-up-"+k}).jqmData("offset",e).jqmData("theme",k).html(b._zPad(d.getMinutes())).appendTo(i)}m.appendTo(b.controlsInput)}}c.mode==="datebox"&&(b._checkConstraints(),b.controlsHeader.empty().html(b._formatHeader(b.theDate)),b.pickerMon.val(b.theDate.getMonth()+1),b.pickerDay.val(b.theDate.getDate()),b.pickerYar.val(b.theDate.getFullYear()),b.dateOK!==!0?b.controlsInput.find("input").addClass("ui-datebox-griddate-disable"):b.controlsInput.find(".ui-datebox-griddate-disable").removeClass("ui-datebox-griddate-disable"));if(c.mode==="calbox"){b.controlsInput.empty().html(c.lang[c.useLang].monthsOfYear[b.theDate.getMonth()]+" "+b.theDate.getFullYear()),b.controlsPlus.empty(),q={today:-1,highlightDay:-1,presetDay:-1,nexttoday:1,thisDate:new Date,maxDate:new Date,minDate:new Date,startDay:!1,currentMonth:!1,weekMode:0,weekDays:null,thisTheme:c.pickPageButtonTheme},q.start=b._getFirstDay(b.theDate),q.end=b._getLastDate(b.theDate),q.lastend=b._getLastDateBefore(b.theDate),q.presetDate=b._makeDate(b.input.val());if(c.calStartDay!==!1||typeof c.lang[c.useLang].calStartDay=="number")c.calStartDay!==!1?(q.start=q.start-c.calStartDay,q.startDay=c.calStartDay):(q.start=q.start-c.lang[c.useLang].calStartDay,q.startDay=c.lang[c.useLang].calStartDay),q.start<0&&(q.start=q.start+7);q.prevtoday=q.lastend-(q.start-1),q.checkDates=c.enableDates===!1&&(c.afterToday!==!1||c.beforeToday!==!1||c.notToday!==!1||c.maxDays!==!1||c.minDays!==!1||c.blackDates!==!1||c.blackDays!==!1),q.thisDate.getMonth()===b.theDate.getMonth()&&q.thisDate.getFullYear()===b.theDate.getFullYear()&&(q.currentMonth=!0,q.highlightDay=q.thisDate.getDate()),q.presetDate.getComp()===b.theDate.getComp()&&(q.presetDay=q.presetDate.getDate()),b.calNoPrev=!1,b.calNoNext=!1,c.afterToday===!0&&(q.currentMonth===!0||q.thisDate.getMonth()>=b.theDate.getMonth()&&b.theDate.getFullYear()===q.thisDate.getFullYear())&&(b.calNoPrev=!0),c.beforeToday===!0&&(q.currentMonth===!0||q.thisDate.getMonth()<=b.theDate.getMonth()&&b.theDate.getFullYear()===q.thisDate.getFullYear())&&(b.calNoNext=!0),c.minDays!==!1&&(q.minDate.adjust("d",-1*c.minDays),b.theDate.getFullYear()===q.minDate.getFullYear()&&b.theDate.getMonth()<=q.minDate.getMonth()&&(b.calNoPrev=!0)),c.maxDays!==!1&&(q.maxDate.adjust("d",c.maxDays),b.theDate.getFullYear()===q.maxDate.getFullYear()&&b.theDate.getMonth()>=q.maxDate.getMonth()&&(b.calNoNext=!0));if(c.calShowDays){c.lang[c.useLang].daysOfWeekShort.length<8&&(c.daysOfWeekShort=c.lang[c.useLang].daysOfWeekShort.concat(c.lang[c.useLang].daysOfWeekShort)),q.weekDays=a("<div>",{"class":"ui-datebox-gridrow"}).appendTo(b.controlsPlus),c.lang[c.useLang].isRTL===!0&&q.weekDays.css("direction","rtl");for(e=0;e<=6;e++)a("<div>"+c.lang[c.useLang].daysOfWeekShort[(e+q.startDay)%7]+"</div>").addClass("ui-datebox-griddate ui-datebox-griddate-empty ui-datebox-griddate-label").appendTo(q.weekDays)}c.fixDateArrays===!0&&(c.blackDates=b._fixArray(c.blackDates),c.highDates=b._fixArray(c.highDates),c.highDatesAlt=b._fixArray(c.highDatesAlt),c.enableDates=b._fixArray(c.enableDates));for(f=0;f<=5;f++){if(f===0||f>0&&q.today>0&&q.today<=q.end){i=a("<div>",{"class":"ui-datebox-gridrow"}),c.lang[c.useLang].isRTL===!0&&i.css("direction","rtl");for(g=0;g<=6;g++)g===0&&(q.weekMode=q.today<1?q.prevtoday-q.lastend+c.calWeekModeFirstDay:q.today+c.calWeekModeFirstDay),g===q.start&&f===0&&(q.today=1),q.today>q.end&&(q.today=-1),q.today<1?c.calShowOnlyMonth?a("<div>",{"class":"ui-datebox-griddate ui-datebox-griddate-empty"}).appendTo(i):(c.enableDates!==!1?a.inArray(b.theDate.copymod([0,-1],[0,0,q.prevtoday]).getISO(),c.enableDates)>-1||a.inArray(b.theDate.copymod([0,1],[0,0,q.nexttoday]).getISO(),c.enableDates)>-1?h=!1:h=!0:c.afterToday!==!1&&f===0&&q.thisDate.getMonth()>=b.theDate.getMonth()-1&&b.theDate.getFullYear()===q.thisDate.getFullYear()&&q.thisDate.getDate()>q.prevtoday||c.beforeToday!==!1&&f!==0&&q.thisDate.getMonth()<=b.theDate.getMonth()+1&&b.theDate.getFullYear()===q.thisDate.getFullYear()&&q.thisDate.getDate()<q.nexttoday||c.blackDays!==!1&&a.inArray(g,c.blackDays)>-1||c.blackDates!==!1&&a.inArray(b.theDate.copymod([0,-1],[0,0,q.prevtoday]).getISO(),c.blackDates)>-1||c.blackDates!==!1&&a.inArray(b.theDate.copymod([0,1],[0,0,q.nexttoday]).getISO(),c.blackDates)>-1?h=!0:h=!1,f===0?(a("<div>"+String(q.prevtoday)+"</div>").addClass("ui-datebox-griddate ui-datebox-griddate-empty").appendTo(i).jqmData("date",c.calWeekMode?q.weekMode+q.lastend:q.prevtoday).jqmData("enabled",!h&&!b.calNoPrev).jqmData("month",-1),q.prevtoday++):(a("<div>"+String(q.nexttoday)+"</div>").addClass("ui-datebox-griddate ui-datebox-griddate-empty").appendTo(i).jqmData("date",c.calWeekMode?q.weekMode:q.nexttoday).jqmData("enabled",!h&&!b.calNoNext).jqmData("month",1),q.nexttoday++)):(h=!1,c.enableDates&&a.inArray(b.theDate.copymod([0],[0,0,q.today]).getISO(),c.enableDates)<0&&(h=!0),q.checkDates&&(c.afterToday&&q.thisDate.getComp()>b.theDate.getComp()+q.today-b.theDate.getDate()&&(h=!0),!h&&c.beforeToday&&q.thisDate.getComp()<b.theDate.getComp()+q.today-b.theDate.getDate()&&(h=!0),!h&&c.notToday&&q.today===q.highlightDay&&(h=!0),!h&&c.maxDays!==!1&&q.maxDate.getComp()<b.theDate.getComp()+q.today-b.theDate.getDate()&&(h=!0),!h&&c.minDays!==!1&&q.minDate.getComp()>b.theDate.getComp()+q.today-b.theDate.getDate()&&(h=!0),!h&&(c.blackDays!==!1||c.blackDates!==!1)&&(a.inArray(g,c.blackDays)>-1||a.inArray(b.theDate.copymod([0],[0,0,q.today]).getISO(),c.blackDates)>-1)&&(h=!0)),c.calHighPicked&&q.today===q.presetDay?q.thisTheme=c.pickPageHighButtonTheme:c.calHighToday&&q.today===q.highlightDay?q.thisTheme=c.pickPageTodayButtonTheme:a.isArray(c.highDatesAlt)&&a.inArray(b.theDate.copymod([0],[0,0,q.today]).getISO(),c.highDatesAlt)>-1?q.thisTheme=c.pickPageOAHighButtonTheme:a.isArray(c.highDates)&&a.inArray(b.theDate.copymod([0],[0,0,q.today]).getISO(),c.highDates)>-1?q.thisTheme=c.pickPageOHighButtonTheme
:a.isArray(c.highDays)&&a.inArray(g,c.highDays)>-1?q.thisTheme=c.pickPageODHighButtonTheme:q.thisTheme=c.pickPageButtonTheme,a("<div>"+String(q.today)+"</div>").addClass("ui-datebox-griddate ui-corner-all ui-btn-up-"+q.thisTheme+(h?" ui-datebox-griddate-disable":"")).jqmData("date",c.calWeekMode?q.weekMode:q.today).jqmData("theme",q.thisTheme).jqmData("enabled",!h).jqmData("month",0).appendTo(i),q.today++)}i.appendTo(b.controlsPlus)}b.controlsPlus.delegate("div.ui-datebox-griddate",c.clickEvent+" vmouseover vmouseout",function(d){d.type===c.clickEvent?(d.preventDefault(),a(this).jqmData("enabled")&&(a(this).jqmData("month")<0?(b.theDate.adjust("m",-1),b.theDate.setDate(a(this).jqmData("date"))):a(this).jqmData("month")>0?(b.theDate.setDate(a(this).jqmData("date")),c.calWeekMode||b.theDate.adjust("m",1)):b.theDate.setDate(a(this).jqmData("date")),b.input.trigger("datebox",{method:"set",value:b._formatDate(b.theDate),date:b.theDate}),b.input.trigger("datebox",{method:"close"}))):a(this).jqmData("enabled")&&typeof a(this).jqmData("theme")!="undefined"&&(c.calWeekMode!==!1&&c.calWeekModeHighlight===!0?a(this).parent().find("div").each(function(){b._hoover(this)}):b._hoover(this))})}c.lang[this.options.useLang].useArabicIndic===!0&&b._makeDisplayIndic()},_getLongOptions:function(b){var c,d={},e,f;a.mobile.ns==""?e="datebox":e=a.mobile.ns.substr(0,a.mobile.ns.length-1)+"Datebox";for(c in b.data())c.substr(0,e.length)===e&&c.length>e.length&&(f=c.substr(e.length),f=f.charAt(0).toLowerCase()+f.slice(1),d[f]=b.data(c));return d},_create:function(){a(document).trigger("dateboxcreate");var b=this,c=a.extend(this.options,this.element.jqmData("options")),c=typeof this.element.jqmData("options")=="undefined"?a.extend(c,this._getLongOptions(this.element)):c;input=this.element,thisTheme=c.theme===!1&&typeof a(b).jqmData("theme")=="undefined"?typeof input.parentsUntil(":jqmData(theme)").parent().jqmData("theme")=="undefined"?c.defaultTheme:input.parentsUntil(":jqmData(theme)").parent().jqmData("theme"):c.theme,focusedEl=input.wrap('<div class="ui-input-datebox ui-shadow-inset ui-corner-all ui-body-'+thisTheme+'"></div>').parent(),theDate=new Date,initDate=new Date(theDate.getTime()),openbutton=a('<a href="#" class="ui-input-clear" title="'+(typeof c.lang[c.useLang].tooltip!="undefined"?c.lang[c.useLang].tooltip:c.lang.en.tooltip)+'">'+(typeof c.lang[c.useLang].tooltip!="undefined"?c.lang[c.useLang].tooltip:c.lang.en.tooltip)+"</a>").bind(c.clickEvent,function(e){e.preventDefault(),c.disabled||(b.input.trigger("datebox",{method:"open"}),b.focusedEl.addClass("ui-focus")),setTimeout(function(){a(e.target).closest("a").removeClass(a.mobile.activeBtnClass)},300)}).appendTo(focusedEl).buttonMarkup({icon:"grid",iconpos:"notext",corners:!0,shadow:!0}).css({"vertical-align":"middle",display:"inline-block"}),thisPage=input.closest(".ui-page"),ns=typeof a.mobile.ns!="undefined"?a.mobile.ns:"",pickPage=a("<div data-"+ns+"role='dialog' class='ui-dialog-datebox' data-"+ns+"theme='"+(c.forceInheritTheme===!1?c.pickPageTheme:thisTheme)+"' ><div data-"+ns+"role='header' data-"+ns+"backbtn='false' data-"+ns+"theme='a'><div class='ui-title'>PlaceHolder</div></div><div data-"+ns+"role='content'></div></div>").appendTo(a.mobile.pageContainer).page().css("minHeight","0px").css("zIndex",c.zindex).addClass(c.transition),pickPageTitle=pickPage.find(".ui-title"),pickPageContent=pickPage.find(".ui-content"),touch=typeof window.ontouchstart!="undefined",START_EVENT=touch?"touchstart":"mousedown",MOVE_EVENT=touch?"touchmove":"mousemove",END_EVENT=touch?"touchend":"mouseup",dragMove=!1,dragStart=!1,dragEnd=!1,dragPos=!1,dragTarget=!1,dragThisDelta=0,c.theme=thisTheme,a.extend(b,{input:input,focusedEl:focusedEl}),c.forceInheritTheme&&(c.pickPageTheme=thisTheme,c.pickPageInputTheme=thisTheme,c.pickPageButtonTheme=thisTheme),c.defaultPickerValue===!1&&c.defaultDate!==!1&&(c.defaultPickerValue=c.defaultDate),c.numberInputEnhance===!0&&(navigator.userAgent.match(/Android/i)||navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPod/i))&&(c.internalInputType="number"),a("label[for='"+input.attr("id")+"']").addClass("ui-input-text").css("verticalAlign","middle"),c.mode==="timeflipbox"&&(c.lang[c.useLang].headerFormat=" "),(c.noButtonFocusMode||c.useInline||c.noButton)&&openbutton.hide(),b.focusedEl.bind(c.clickEvent,function(){!c.disabled&&(c.noButtonFocusMode||c.focusMode)&&(b.input.trigger("datebox",{method:"open"}),b.focusedEl.addClass("ui-focus"),b.input.removeClass("ui-focus"))}),b.input.removeClass("ui-corner-all ui-shadow-inset").focus(function(){c.disabled||b.focusedEl.addClass("ui-focus"),b.input.removeClass("ui-focus")}).blur(function(){b.focusedEl.removeClass("ui-focus"),b.input.removeClass("ui-focus")}).change(function(){b.theDate=b._makeDate(b.input.val()),b._update()}),b.input.bind("datebox",b._dateboxHandler),pickPage.find(".ui-header a").unbind("click vclick").bind(c.clickEvent,function(a){a.preventDefault(),a.stopImmediatePropagation(),b.input.trigger("datebox",{method:"close",fromCloseButton:!1})}),a.extend(b,{pickPage:pickPage,thisPage:thisPage,pickPageContent:pickPageContent,pickPageTitle:pickPageTitle,theDate:theDate,initDate:initDate,touch:touch,START_DRAG:START_EVENT,MOVE_DRAG:MOVE_EVENT,END_DRAG:END_EVENT,dragMove:dragMove,dragStart:dragStart,dragEnd:dragEnd,dragPos:dragPos}),typeof a.event.special.mousewheel!="undefined"&&(c.wheelExists=!0),b._buildPage(),c.swipeEnabled&&(a(document).bind(b.MOVE_DRAG,function(a){if(b.dragMove){if(c.mode==="slidebox")return b.dragEnd=b.touch?a.originalEvent.changedTouches[0].pageX:a.pageX,b.dragTarget.css("marginLeft",b.dragPos+b.dragEnd-b.dragStart+"px"),a.preventDefault(),a.stopPropagation(),!1;if(c.mode==="flipbox"||c.mode==="timeflipbox")return b.dragEnd=b.touch?a.originalEvent.changedTouches[0].pageY:a.pageY,b.dragTarget.css("marginTop",b.dragPos+b.dragEnd-b.dragStart+"px"),a.preventDefault(),a.stopPropagation(),!1;if(c.mode==="durationbox"||c.mode==="timebox"||c.mode==="datebox")return b.dragEnd=b.touch?a.originalEvent.changedTouches[0].pageY:a.pageY,(b.dragEnd-b.dragStart)%2===0&&(dragThisDelta=(b.dragEnd-b.dragStart)/-2,dragThisDelta<b.dragPos?b._offset(b.dragTarget,-1*(b.dragTarget==="i"?c.minuteStep:1)):dragThisDelta>b.dragPos&&b._offset(b.dragTarget,b.dragTarget==="i"?c.minuteStep:1),b.dragPos=dragThisDelta),a.preventDefault(),a.stopPropagation(),!1}}),a(document).bind(b.END_DRAG,function(a){if(b.dragMove){b.dragMove=!1;if(c.mode==="slidebox"){if(b.dragEnd!==!1&&Math.abs(b.dragStart-b.dragEnd)>25){a.preventDefault(),a.stopPropagation();switch(b.dragTarget.parent().jqmData("rowtype")){case"y":b._offset("y",parseInt((b.dragStart-b.dragEnd)/84,10));break;case"m":b._offset("m",parseInt((b.dragStart-b.dragEnd)/51,10));break;case"d":b._offset("d",parseInt((b.dragStart-b.dragEnd)/32,10));break;case"h":b._offset("h",parseInt((b.dragStart-b.dragEnd)/32,10));break;case"i":b._offset("i",parseInt((b.dragStart-b.dragEnd)/32,10))}}}else if(c.mode==="flipbox"||c.mode==="timeflipbox")if(b.dragEnd!==!1){a.preventDefault(),a.stopPropagation();var e=b.dragTarget.parent().parent().jqmData("field"),f=parseInt((b.dragStart-b.dragEnd)/30,10);b._offset(e,f*(e==="i"?c.minuteStep:1))}b.dragStart=!1,b.dragEnd=!1}})),b.input.is(":disabled")&&b.disable(),c.disableManualInput===!0&&b.input.attr("readonly",!0),a(document).trigger("dateboxaftercreate")},_makeElement:function(a,b){var c=this,d=!1,e=!1;e=a.clone();if(typeof b.attr!="undefined")for(d in b.attr)b.attr.hasOwnProperty(d)&&e.jqmData(d,b.attr[d]);return e},_eventEnterValue:function(a){var b=this,c=b.options,d=!1;if(a.val()!==""&&b._isInt(a.val())){switch(a.jqmData("field")){case"m":b.theDate.setMonth(parseInt(a.val(),10)-1);break;case"d":b.theDate.setDate(parseInt(a.val(),10));break;case"y":b.theDate.setFullYear(parseInt(a.val(),10));break;case"i":b.theDate.setMinutes(parseInt(a.val(),10));break;case"h":d=parseInt(a.val(),10),d===12&&(c.lang[c.useLang].timeFormat===12||c.timeFormatOverride===12)&&b.pickerMeri.val()===c.meridiemLetters[0]&&(d=0),b.theDate.setHours(d)}b._update()}},_buildInternals:function(){var b=this,c=b.options,d,e,f,g,h=a("<div><a href='#'></a></div>"),i=a("<div>",{"class":"ui-datebox-container ui-overlay-shadow ui-corner-all ui-datebox-hidden pop ui-body-"+c.pickPageTheme}).css("zIndex",c.zindex),j=a("<input type='"+c.internalInputType+"' />").addClass("ui-input-text ui-corner-all ui-shadow-inset ui-datebox-input ui-body-"+c.pickPageInputTheme),k=a("<input type='text' />").addClass("ui-input-text ui-corner-all ui-shadow-inset ui-datebox-input ui-body-"+c.pickPageInputTheme),l=a("<div>",{"class":"ui-datebox-controls"}),m=a("<div class='ui-overlay-shadow'><ul></ul></div>"),n,o,p,q,r,s,t,u,v,w,x,y;b.calNoNext=!1,b.calNoPrev=!1,b.setButton=!1,b.clearButton=!1,b.dateOK=!0;if(c.fieldsOrderOverride===!1)switch(c.mode){case"timebox":case"timeflipbox":c.fieldsOrder=c.lang[c.useLang].timeFieldOrder;break;case"slidebox":c.fieldsOrder=c.lang[c.useLang].slideFieldOrder;break;default:c.fieldsOrder=c.lang[c.useLang].dateFieldOrder}else c.fieldsOrder=c.fieldsOrderOverride;c.timeOutputOverride!==!1?c.timeOutput=c.timeOutputOverride:c.timeFormatOverride===!1?c.timeOutput=c.timeFormats[c.lang[c.useLang].timeFormat]:c.timeOutput=c.timeFormats[c.timeFormatOverride],c.dateFormat!==!1?c.dateOutput=c.dateFormat:typeof c.lang[c.useLang].dateFormat!="undefined"?c.dateOutput=c.lang[c.useLang].dateFormat:c.dateOutput=c.defaultDateFormat,b.pickerContent.empty();if(c.mode==="datebox"||c.mode==="timebox"){r=a("<div class='ui-datebox-header'><h4>Unitialized</h4></div>").appendTo(b.pickerContent).find("h4"),n=l.clone().appendTo(b.pickerContent),o=l.clone().appendTo(b.pickerContent),p=l.clone().appendTo(b.pickerContent),q=l.clone().appendTo(b.pickerContent),c.mode==="timebox"&&r.parent().empty(),v=b._makeElement(j,{attr:{field:"m",amount:1}}),w=b._makeElement(j,{attr:{field:"d",amount:1}}),x=b._makeElement(j,{attr:{field:"y",amount:1}}),s=b._makeElement(j,{attr:{field:"h",amount:1}}),t=b._makeElement(j,{attr:{field:"i",amount:1}}),u=b._makeElement(k,{attr:{field:"a",amount:c.minuteStep}}),o.delegate("input","keyup",function(){b._eventEnterValue(a(this))}),c.wheelExists&&o.delegate("input","mousewheel",function(c,d){c.preventDefault(),b._offset(a(this).jqmData("field"),(d<0?-1:1)*a(this).jqmData("amount"))});for(d=0;d<=c.fieldsOrder.length;d++)c.fieldsOrder[d]==="y"&&x.appendTo(o),c.fieldsOrder[d]==="m"&&v.appendTo(o),c.fieldsOrder[d]==="d"&&w.appendTo(o),c.fieldsOrder[d]==="h"&&s.appendTo(o),c.fieldsOrder[d]==="i"&&t.appendTo(o),c.fieldsOrder[d]==="a"&&(c.lang[c.useLang].timeFormat===12||c.timeFormatOverride===12)&&u.appendTo(o);c.swipeEnabled&&o.delegate("input",b.START_DRAG,function(c){b.dragMove||(b.dragMove=!0,b.dragTarget=a(this).jqmData("field"),b.dragPos=0,b.dragStart=b.touch?c.originalEvent.changedTouches[0].pageY:c.pageY,b.dragEnd=!1,c.stopPropagation())}),c.noSetButton===!1&&(b.setButton=a("<a href='#'>PlaceHolder</a>").appendTo(q).buttonMarkup({theme:c.pickPageTheme,icon:"check",iconpos:"left",corners:!0,shadow:!0}).bind(c.clickEvent,function(a){a.preventDefault(),b.dateOK===!0&&(c.mode==="timebox"?b.input.trigger("datebox",{method:"set",value:b._formatTime(b.theDate),date:b.theDate}):b.input.trigger("datebox",{method:"set",value:b._formatDate(b.theDate),date:b.theDate}),b.input.trigger("datebox",{method:"close"}))}));for(d=0;d<b.options.fieldsOrder.length;d++)if(c.fieldsOrder[d]!=="a"||c.lang[c.useLang].timeFormat===12||c.timeFormatOverride===12)for(e=0;e<2;e++)h.clone().appendTo(e===0?n:p).buttonMarkup({theme:c.pickPageButtonTheme,icon:e===0?"plus":"minus",iconpos:"bottom",corners:!0,shadow:!0}).jqmData("field",c.fieldsOrder[d]).jqmData("amount",c.fieldsOrder[d]==="i"?c.minuteStep:1);n.delegate("div",c.clickEvent,function(c){c.preventDefault(),b._offset(a(this).jqmData("field"),a(this).jqmData("amount"))}),p.delegate("div",c.clickEvent,function(c){c.preventDefault(),b._offset(a(this).jqmData("field"),a(this).jqmData("amount")*-1)}),a.extend(b,{controlsHeader:r,pickerDay:w,pickerMon:v,pickerYar:x,pickerHour:s,pickerMins:t,pickerMeri:u,controlsInput:o}),b.pickerContent.appendTo(b.thisPage)}if(c.mode==="durationbox"){n=l.clone().removeClass("ui-datebox-controls").addClass("ui-datebox-scontrols").appendTo(b.pickerContent),o=n.clone().appendTo(b.pickerContent),p=n.clone().appendTo(b.pickerContent),q=l.clone().appendTo(b.pickerContent),w=j.removeClass("ui-datebox-input"),s=w.clone(),t=w.clone(),y=w.clone(),o.delegate("input","keyup",function(){a(this).val()!==""&&b._updateduration()}),c.wheelExists&&o.delegate("input","mousewheel",function(c,d){c.preventDefault(),b._offset(a(this).parent().jqmData("field"),d<0?-1:1)});for(d=0;d<c.durationOrder.length;d++)switch(c.durationOrder[d]){case"d":a("<div>",{"class":"ui-datebox-sinput"}).jqmData("field","d").append(w).appendTo(o).prepend("<label>"+c.lang[c.useLang].durationLabel[0]+"</label>");break;case"h":a("<div>",{"class":"ui-datebox-sinput"}).jqmData("field","h").append(s).appendTo(o).prepend("<label>"+c.lang[c.useLang].durationLabel[1]+"</label>");break;case"i":a("<div>",{"class":"ui-datebox-sinput"}).jqmData("field","i").append(t).appendTo(o).prepend("<label>"+c.lang[c.useLang].durationLabel[2]+"</label>");break;case"s":a("<div>",{"class":"ui-datebox-sinput"}).jqmData("field","s").append(y).appendTo(o).prepend("<label>"+c.lang[c.useLang].durationLabel[3]+"</label>")}c.swipeEnabled&&o.delegate("input",b.START_DRAG,function(c){b.dragMove||(b.dragMove=!0,b.dragTarget=a(this).parent().jqmData("field"),b.dragPos=0,b.dragStart=b.touch?c.originalEvent.changedTouches[0].pageY:c.pageY,b.dragEnd=!1,c.stopPropagation())}),c.noSetButton===!1&&(b.setButton=a("<a href='#'>PlaceHolder</a>").appendTo(q).buttonMarkup({theme:c.pickPageTheme,icon:"check",iconpos:"left",corners:!0,shadow:!0}).bind(c.clickEvent,function(a){a.preventDefault(),b.input.trigger("datebox",{method:"set",value:b._formatTime(b.theDate),date:b.theDate}),b.input.trigger("datebox",{method:"close"})}));for(d=0;d<c.durationOrder.length;d++)for(e=0;e<2;e++)h.clone().appendTo(e===0?n:p).buttonMarkup({theme:c.pickPageButtonTheme,icon:e===0?"plus":"minus",iconpos:"bottom",corners:!0,shadow:!0}).jqmData("field",c.durationOrder[d]);n.delegate("div",c.clickEvent,function(d){d.preventDefault(),b._offset(a(this).jqmData("field"),c.durationSteppers[a(this).jqmData("field")])}),p.delegate("div",c.clickEvent,function(d){d.preventDefault(),b._offset(a(this).jqmData("field"),c.durationSteppers[a(this).jqmData("field")]*-1)}),a.extend(b,{pickerHour:s,pickerMins:t,pickerDay:w,pickerSecs:y}),b.pickerContent.appendTo(b.thisPage)}c.mode==="slidebox"&&(r=a("<div class='ui-datebox-header'><h4>Unitialized</h4></div>").appendTo(b.pickerContent).find("h4"),o=a("<div>").addClass("ui-datebox-slide").appendTo(b.pickerContent),q=a("<div>",{"class":"ui-datebox-controls"}).appendTo(b.pickerContent),c.noSetButton===!1&&(b.setButton=a("<a href='#'>PlaceHolder</a>").appendTo(q).buttonMarkup({theme:c.pickPageTheme,icon:"check",iconpos:"left",corners:!0,shadow:!0}).bind(c.clickEvent,function(a){a.preventDefault(),b.dateOK===!0&&(b.input.trigger("datebox",{method:"set",value:b._formatDate(b.theDate),date:b.theDate}),b.input.trigger("datebox",{method:"close"}))})),a.extend(b,{controlsHeader:r,controlsInput:o}),b.pickerContent.appendTo(b.thisPage));if(c.mode==="flipbox"||c.mode==="timeflipbox"){r=a("<div class='ui-datebox-header'><h4>Unitialized</h4></div>").appendTo(b.pickerContent).find("h4"),o=a("<div>",{"class":"ui-datebox-flipcontent"}).appendTo(b.pickerContent),n=a("<div>",{"class":"ui-datebox-flipcenter ui-overlay-shadow"}).css("pointerEvents","none").appendTo(b.pickerContent),q=l.clone().appendTo(b.pickerContent),w=b._makeElement(m,{attr:{field:"d",amount:1}}),v=b._makeElement(m,{attr:{field:"m",amount:1}}),x=b._makeElement(m,{attr:{field:"y",amount:1}}),s=b._makeElement(m,{attr:{field:"h",amount:1}}),t=b._makeElement(m,{attr:{field:"i",amount:c.minuteStep}}),u=b._makeElement(m,{attr:{field:"a",amount:1}}),c.wheelExists&&o.delegate("div","mousewheel",function(c,d){c.preventDefault(),b._offset(a(this).jqmData("field"),(d<0?-1:1)*a(this).jqmData("amount"))});for(d=0;d<=c.fieldsOrder.length;d++)c.fieldsOrder[d]==="y"&&x.appendTo(o),c.fieldsOrder[d]==="m"&&v.appendTo(o),c.fieldsOrder[d]==="d"&&w.appendTo(o),c.fieldsOrder[d]==="h"&&s.appendTo(o),c.fieldsOrder[d]==="i"&&t.appendTo(o),c.fieldsOrder[d]==="a"&&(c.lang[c.useLang].timeFormat===12||c.timeFormatOverride===12)&&u.appendTo(o);c.swipeEnabled&&(o.delegate("ul",b.START_DRAG,function(c,d){b.dragMove||(typeof d!="undefined"&&(c=d),b.dragMove=!0,b.dragTarget=a(this).find("li").first(),b.dragPos=parseInt(b.dragTarget.css("marginTop").replace(/px/i,""),10),b.dragStart=b.touch?c.originalEvent.changedTouches[0].pageY:c.pageY,b.dragEnd=!1,c.stopPropagation(),c.preventDefault())}),n.bind(b.START_DRAG,function(d){b.dragMove||(b.dragTarget=b.touch?d.originalEvent.changedTouches[0].pageX-a(d.currentTarget).offset().left:d.pageX-a(d.currentTarget).offset().left,c.fieldsOrder.length===3?a(b.controlsInput.find("ul").get(parseInt(b.dragTarget/87,10))).trigger(b.START_DRAG,d):c.fieldsOrder.length===2&&a(b.controlsInput.find("ul").get(parseInt(b.dragTarget/130,10))).trigger(b.START_DRAG,d))})),c.noSetButton===!1&&(b.setButton=a("<a href='#'>PlaceHolder</a>").appendTo(q).buttonMarkup({theme:c.pickPageTheme,icon:"check",iconpos:"left",corners:!0,shadow:!0}).bind(c.clickEvent,function(a){a.preventDefault(),b.dateOK===!0&&(c.mode==="timeflipbox"?b.input.trigger("datebox",{method:"set",value:b._formatTime(b.theDate),date:b.theDate}):b.input.trigger("datebox",{method:"set",value:b._formatDate(b.theDate),date:b.theDate}),b.input.trigger("datebox",{method:"close"}))})),a.extend(b,{controlsHeader:r,controlsInput:o,pickerDay:w,pickerMon:v,pickerYar:x,pickerHour:s,pickerMins:t,pickerMeri:u}),b.pickerContent.appendTo(b.thisPage)}c.mode==="calbox"&&(r=a("<div>",{"class":"ui-datebox-gridheader"}).appendTo(b.pickerContent),n=a("<div>",{"class":"ui-datebox-grid"}).appendTo(b.pickerContent),q=l.clone().appendTo(b.pickerContent),o=a("<div class='ui-datebox-gridlabel'><h4>Uninitialized</h4></div>").appendTo(r).find("h4"),c.swipeEnabled&&b.pickerContent.bind("swipeleft",function(){b.calNoNext||b._offset("m",1)}).bind("swiperight",function(){b.calNoPrev||b._offset("m",-1)}),c.wheelExists&&b.pickerContent.bind("mousewheel",function(a,c){a.preventDefault(),c>0&&!b.calNoNext&&(b.theDate.getDate()>28&&b.theDate.setDate(1),b._offset("m",1)),c<0&&!b.calNoPrev&&(b.theDate.getDate()>28&&b.theDate.setDate(1),b._offset("m",-1))}),a("<div class='ui-datebox-gridplus"+(c.lang[c.useLang].isRTL===!0?"-rtl":"")+"'><a href='#'>"+(typeof c.lang[c.useLang].nextMonth!="undefined"?c.lang[c.useLang].nextMonth:c.lang.en.nextMonth)+"</a></div>").prependTo(r).buttonMarkup({theme:c.pickPageButtonTheme,icon:"plus",inline:!0,iconpos:"notext",corners:!0,shadow:!0}).bind(c.clickEvent,function(a){a.preventDefault(),b.calNoNext||(b.theDate.getDate()>28&&b.theDate.setDate(1),b._offset("m",1))}),a("<div class='ui-datebox-gridminus"+(c.lang[c.useLang].isRTL===!0?"-rtl":"")+"'><a href='#'>"+(typeof c.lang[c.useLang].prevMonth!="undefined"?c.lang[c.useLang].prevMonth:c.lang.en.prevMonth)+"</a></div>").prependTo(r).buttonMarkup({theme:c.pickPageButtonTheme,icon:"minus",inline:!0,iconpos:"notext",corners:!0,shadow:!0}).bind(c.clickEvent,function(a){a.preventDefault(),b.calNoPrev||(b.theDate.getDate()>28&&b.theDate.setDate(1),b._offset("m",-1))}),c.calTodayButton===!0&&(b.setButton=a("<a href='#'>PlaceHolder</a>").appendTo(q).buttonMarkup({theme:c.pickPageTheme,icon:"check",iconpos:"left",corners:!0,shadow:!0}).bind(c.clickEvent,function(a){a.preventDefault(),b.theDate=new Date,b.theDate=new Date(b.theDate.getFullYear(),b.theDate.getMonth(),b.theDate.getDate(),0,0,0,0),b.input.trigger("datebox",{method:"doset"})})),a.extend(b,{controlsInput:o,controlsPlus:n}),b.pickerContent.appendTo(b.thisPage)),c.useClearButton===!0&&(b.clearButton=a("<a href='#'>PlaceHolder</a>").appendTo(q).buttonMarkup({theme:c.pickPageTheme,icon:"delete",iconpos:"left",corners:!0,shadow:!0}).bind(c.clickEvent,function(a){a.preventDefault(),b.input.val(""),b.input.trigger("datebox",{method:"clear"}),b.input.trigger("datebox",{method:"close"})})),c.collapseButtons&&b.clearButton!==!1&&b.setButton!==!1&&q.addClass("ui-datebox-collapse")},_buttonsTitle:function(){var a=this,b=this.options;if(b.titleDialogLabel===!1)if(typeof this.element.attr("title")!="undefined")a.pickPageTitle.html(this.element.attr("title"));else if(this.focusedEl.parent().find("label").text()!=="")a.pickPageTitle.html(this.focusedEl.parent().find("label").text());else switch(b.mode){case"timebox":case"timeflipbox":a.pickPageTitle.html(b.lang[b.useLang].titleTimeDialogLabel);break;default:a.pickPageTitle.html(b.lang[b.useLang].titleDateDialogLabel)}else a.pickPageTitle.html(b.titleDialogLabel);a.clearButton!==!1&&a.clearButton.find(".ui-btn-text").html(b.lang[b.useLang].clearButton);if(a.setButton!==!1)switch(b.mode){case"timebox":case"timeflipbox":a.setButton.find(".ui-btn-text").html(b.lang[b.useLang].setTimeButtonLabel);break;case"durationbox":a.setButton.find(".ui-btn-text").html(b.lang[b.useLang].setDurationButtonLabel);break;case"calbox":a.setButton.find(".ui-btn-text").html(b.lang[b.useLang].calTodayButtonLabel);break;default:a.setButton.find(".ui-btn-text").html(b.lang[b.useLang].setDateButtonLabel)}},_buildPage:function(){var b=this,c=b.options,d=a("<div>",{"class":"ui-datebox-container ui-overlay-shadow ui-corner-all ui-datebox-hidden "+c.transition+" ui-body-"+c.pickPageTheme}).css("zIndex",c.zindex),e=a("<div>",{"class":"ui-datebox-screen ui-datebox-hidden"+(c.useModal?" ui-datebox-screen-modal":"")}).css({"z-index":c.zindex-1}).appendTo(b.thisPage).bind(c.clickEvent,function(a){a.preventDefault(),b.input.trigger("datebox",{method:"close"})});c.noAnimation&&d.removeClass(c.transition),a.extend(b,{pickerContent:d,screen:e}),b._buildInternals(),c.useInline||c.useInlineBlind?(b.input.parent().parent().append(b.pickerContent),c.useInlineHideInput&&b.input.parent().hide(),b.input.trigger("change"),b.pickerContent.removeClass("ui-datebox-hidden")):c.centerWindow&&c.useInlineHideInput&&b.input.parent().hide(),c.useInline&&(b.pickerContent.addClass("ui-datebox-inline"),b.open()),c.useInlineBlind&&(b.pickerContent.addClass("ui-datebox-inlineblind"),b.pickerContent.hide())},hardreset:function(){this._buildInternals(),this.refresh(),this._buttonsTitle()},refresh:function(){this.options.useInline===!0&&this.input.trigger("change"),this._update()},open:function(){var b=this,c=this.options,d=!1,e=c.noAnimation?"none":c.transition,f,g;if(c.openCallback!==!1){a.isFunction(this.options.openCallback)||(typeof window[c.openCallback]!="undefined"?c.openCallback=window[c.openCallback]:c.openCallback=new Function(c.openCallback)),f=c.openCallback.apply(b,a.merge([b.theDate],c.openCallbackArgs));if(f==0)return!1}b._buttonsTitle();if(this.options.useInlineBlind)return this.pickerContent.slideDown(),!1;if(this.options.useInline)return!0;if(this.pickPage.is(":visible"))return!1;this.theDate=this._makeDate(this.input.val()),this._update(),this.input.blur();if(a(document).width()>400&&!c.useDialogForceTrue||c.useDialogForceFalse||c.fullScreen){d=this._getCoords(this),c.useDialog=!1,c.nestedBox===!0&&c.fullScreen===!1&&(g=a(".ui-page-active").first(),a(g).append(b.pickerContent),a(g).append(b.screen));if(c.fullScreenAlways===!1||d.width>399)c.useModal===!0?b.screen.fadeIn("slow"):setTimeout(function(){b.screen.removeClass("ui-datebox-hidden")},500);c.fullScreenAlways===!0||c.fullScreen===!0&&d.width<400?b.pickerContent.addClass("in").css({position:"absolute","text-align":"center",top:d.fullTop-5,left:d.fullLeft-5,height:d.high,width:d.width}).removeClass("ui-datebox-hidden"):(b.pickerContent.addClass("ui-overlay-shadow in").css({position:"absolute",top:d.winTop,left:d.winLeft}).removeClass("ui-datebox-hidden"),a(document).bind("orientationchange.datebox",{widget:b},function(a){b._orientChange(a)}),c.resizeListener===!0&&a(window).bind("resize.datebox",{widget:b},function(a){b._orientChange(a)}))}else b.thisPage.unbind("pagehide.remove"),c.useDialog=!0,b.pickPageContent.append(b.pickerContent),b.pickerContent.css({top:"auto",left:"auto",marginLeft:"auto",marginRight:"auto"}).removeClass("ui-overlay-shadow ui-datebox-hidden"),a.mobile.changePage(b.pickPage,{transition:e})},close:function(b){var c=this,d=this.options,e;if(d.useInlineBlind)return c.pickerContent.slideUp(),!1;if(d.useInline)return!0;d.useDialog?(b||a(c.pickPage).dialog("close"),c.thisPage.jqmData("page").options.domCache||c.thisPage.bind("pagehide.remove",function(){a(c).remove()}),c.pickerContent.addClass("ui-datebox-hidden").removeAttr("style").css("zIndex",c.options.zindex),c.thisPage.append(c.pickerContent)):(d.useModal?c.screen.fadeOut("slow"):c.screen.addClass("ui-datebox-hidden"),c.pickerContent.addClass("ui-datebox-hidden").removeAttr("style").css("zIndex",c.options.zindex).removeClass("in")),c.focusedEl.removeClass("ui-focus"),a(document).unbind("orientationchange.datebox"),d.resizeListener===!0&&a(window).unbind("resize.datebox"),d.closeCallback!==!1&&(a.isFunction(d.closeCallback)||(typeof window[d.closeCallback]!="undefined"?d.closeCallback=window[d.closeCallback]:d.closeCallback=new Function(d.closeCallback)),d.closeCallback.apply(c,a.merge([c.theDate],d.closeCallbackArgs)))},disable:function(){this.element.attr("disabled",!0),this.element.parent().addClass("ui-disabled"),this.options.disabled=!0,this.element.blur(),this.input.trigger("datebox",{method:"disable"})},enable:function(){this.element.attr("disabled",!1),this.element.parent().removeClass("ui-disabled"),this.options.disabled=!1,this.input.trigger("datebox",{method:"enable"})},_setOption:function(b,c){var d=["minYear","maxYear","afterToday","beforeToday","maxDays","minDays","highDays","highDates","blackDays","blackDates","enableDates"];a.Widget.prototype._setOption.apply(this,arguments),a.inArray(b,d)>-1?this.refresh():this.hardreset()}}),a(document).bind("pagebeforecreate",function(b){a(":jqmData(role='datebox')",b.target).each(function(){a(this).prop("type","text")})}),a(document).bind("pagecreate create",function(b){a(document).trigger("dateboxbeforecreate"),a(":jqmData(role='datebox')",b.target).each(function(){typeof a(this).data("datebox")=="undefined"&&a(this).datebox()})})})(jQuery);